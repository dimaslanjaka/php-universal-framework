$(document).ready((function(){setTimeout(()=>{$(".mdb-select").not(".select-wrapper").materialSelect(),$("input,textarea").each((function(i,el){if(!empty($(el).val())){var labels=$(el).closest("div").find("label");labels.length&&(labels.hasClass("active")||labels.addClass("active"))}})),$('[data-toggle="modal"]').each((function(i,el){$(el).attr("data-backdrop")||$(el).attr("data-backdrop","true")}))},2e3)}));$(window,document,void 0).ready((function(){framework().captcha.get(),$(document).on("submit","form",(function(e){e.preventDefault();var t=$(this),id=t.attr("id"),s=t.data("success"),err=t.data("error"),c=t.data("complete");ajx({url:t.attr("action"),method:t.attr("method"),data:t.serialize(),headers:{hname:framework().captcha.id()}},s,err,c),"ACQUISITION"==id&&($("#acqBTN").prop("disabled",!0).html('<i class="fad fa-clock mr-2"></i> please wait'),Cookies.set(ACQ,"please wait",10,"s"))})),smartform()}));const ACQ="ACQ_pending";function acq_wait(){var isPending;null==Cookies.get(ACQ)?$("#acqBTN").prop("disabled",!1).html('<i class="fad fa-paper-plane"></i>'):$("#acqBTN").prop("disabled",!0).html('<i class="fad fa-clock mr-2"></i> please wait')}acq_wait(),setInterval(acq_wait,5e3),activateTable();var LogData=[];function activateTable(res){ajx({url:"/coupon/dashboard/im3/otp?check"},(function(res){res.hasOwnProperty("tokenid")&&!empty(res.tokenid)?$("#tbl-dor").removeAttr("aria-disabled"):$("#tbl-dor").attr("aria-disabled","true"),res.hasOwnProperty("msisdn")&&($('[id="i-msisdn"]').not("input,textarea").html(res.msisdn),$('input[id="i-msisdn"]').val(res.msisdn)),res.hasOwnProperty("code")&&$('input[id="i-coupon"]').val(res.code),res.hasOwnProperty("success")&&($("#i-success").text(res.success),res.hasOwnProperty("limit")&&($("#i-limit").text(res.limit),$("#i-remain").text(res.limit-res.success))),res.hasOwnProperty("log")&&(LogData=Array.isArray(res.log)?res.log:[res.log],log_reload()),res.hasOwnProperty("data")&&res.data.forEach((function(data,id){data.hasOwnProperty("remainingQuota")&&data.name.includes("ACQUISITION")&&$("#i-acquota").html(data.remainingQuota)}))}))}var LogTable=null;function log_reload(){LogTable?(LogTable.clear().draw(),LogTable.rows.add(LogData),LogTable.columns.adjust().draw()):(LogTable=$("table#log").DataTable({data:LogData,columns:[{title:"MSIDN",data:"msisdn"},{title:"Coupon Code",data:"coupon"},{title:"Date",data:"date"}]}),$(".dataTables_length").addClass("bs-select"))}$.fn.dataTable.ext.errMode="none";