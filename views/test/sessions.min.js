class JSONViewer{constructor(){this._dom={},this._dom.container=document.createElement("pre"),this._dom.container.classList.add("json-viewer")}showJSON(e,t,n){t="number"===typeof t?t:-1,n="number"===typeof n?n:-1;var a=this._processInput(e),s=this._walk(a,t,n,0);this._dom.container.innerHTML="",this._dom.container.appendChild(s)}getContainer(){return this._dom.container}_processInput(e){if(e&&"object"===typeof e)return e;throw"Input value is not object or array!"}_walk(e,t,n,a){var s=document.createDocumentFragment(),i=t>=0&&a>=t,r=n>=0&&a>=n;switch(typeof e){case"object":if(e){var d=Array.isArray(e),o=d?e:Object.keys(e);if(0===a){var l=this._createItemsCount(o.length),c=this._createLink(d?"[":"{");o.length?(c.addEventListener("click",function(){i||(c.classList.toggle("collapsed"),l.classList.toggle("hide"),this._dom.container.querySelector("ul").classList.toggle("hide"))}.bind(this)),r&&(c.classList.add("collapsed"),l.classList.remove("hide"))):c.classList.add("empty"),c.appendChild(l),s.appendChild(c)}if(o.length&&!i){var u=o.length-1,p=document.createElement("ul");p.setAttribute("data-level",a),p.classList.add("type-"+(d?"array":"object")),o.forEach((function(s,i){var r=d?s:e[s],o=document.createElement("li");if("object"===typeof r){if(!r||r instanceof Date)o.appendChild(document.createTextNode(d?"":s+": ")),o.appendChild(this._createSimple(r||null));else{var l=Array.isArray(r),c=l?r.length:Object.keys(r).length;if(c){var h=("string"===typeof s?s+": ":"")+(l?"[":"{"),m=this._createLink(h),v=this._createItemsCount(c);t>=0&&a+1>=t?o.appendChild(document.createTextNode(h)):(m.appendChild(v),o.appendChild(m)),o.appendChild(this._walk(r,t,n,a+1)),o.appendChild(document.createTextNode(l?"]":"}"));var g=o.querySelector("ul"),f=function(){m.classList.toggle("collapsed"),v.classList.toggle("hide"),g.classList.toggle("hide")};m.addEventListener("click",f),n>=0&&a+1>=n&&f()}else o.appendChild(document.createTextNode(s+": "+(l?"[]":"{}")))}}else d||o.appendChild(document.createTextNode(s+": ")),o.appendChild(this._walk(r,t,n,a+1));i<u&&o.appendChild(document.createTextNode(",")),p.appendChild(o)}),this),s.appendChild(p)}else if(o.length&&i){var h=this._createItemsCount(o.length);h.classList.remove("hide"),s.appendChild(h)}if(0===a){if(!o.length){h=this._createItemsCount(0);h.classList.remove("hide"),s.appendChild(h)}s.appendChild(document.createTextNode(d?"]":"}")),r&&s.querySelector("ul").classList.add("hide")}break}default:s.appendChild(this._createSimple(e));break}return s}_createSimple(e){var t=document.createElement("span"),n=typeof e,a=e;return"string"===n?a='"'+e+'"':null===e?(n="null",a="null"):void 0===e?a="undefined":e instanceof Date&&(n="date",a=e.toString()),t.classList.add("type-"+n),t.innerHTML=a,t}_createItemsCount(e){var t=document.createElement("span");return t.classList.add("items-ph"),t.classList.add("hide"),t.innerHTML=this._getItemsTitle(e),t}_createLink(e){var t=document.createElement("a");return t.classList.add("list-link"),t.href="javascript:void(0)",t.innerHTML=e||"",t}_getItemsTitle(e){var t=e>1||0===e?"items":"item";return e+" "+t}}var jsonObj={},jsonViewer=new JSONViewer;document.querySelector("#json").appendChild(jsonViewer.getContainer());var textarea=document.querySelector("textarea"),setJSON=function(){try{var e=textarea.value;jsonObj=JSON.parse(e)}catch(t){alert(t)}};setJSON();var loadJsonBtn=document.querySelector("button.load-json"),collapseBtn=document.querySelector("button.collapse"),expandBtn=document.querySelector("button.expand"),resetBtn=document.querySelector("button.reset");loadJsonBtn.addEventListener("click",(function(){setJSON(),jsonViewer.showJSON(jsonObj)})),collapseBtn.addEventListener("click",(function(){jsonViewer.showJSON(jsonObj,null,1)})),expandBtn.addEventListener("click",(function(){setJSON(),jsonViewer.showJSON(jsonObj)})),resetBtn.addEventListener("click",(function(){document.getElementById("msg").value=""})),$("#load-j").trigger("click");