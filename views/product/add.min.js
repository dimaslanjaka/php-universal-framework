function generateGenericNames(e){$("#generic-name").text(`${$("#inputProductName").val()} (${$("#aliasInput").val()})`)}function preview(e){$("#imagePreview").css("background-image","url("+e+")"),$("#imagePreview").hide(),$("#imagePreview").fadeIn(650)}function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){preview(e.target.result)},t.readAsDataURL(e.files[0])}}function isValidHttpUrl(e){let t;try{t=new URL(e)}catch(a){return!1}return"http:"===t.protocol||"https:"===t.protocol}function url2base64(e,t){var a=new XMLHttpRequest;a.onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(a.response)},a.open("GET",e),a.responseType="blob",a.send()}(function(){smartform(),$(document).on("submit","form",(function(e){e.preventDefault(),jAjax({url:location.href,data:$(this).serialize(),method:"POST",success:function(e){console.log(e),e.success?(toastr.success("Update Successful","Success"),location.href="/product"):toastr.error("Update Failed","Failed")}})})),$(document).on("keyup","#inputProductName,#aliasInput",generateGenericNames),$("#imageUpload").change((function(){readURL(this)})),$("#urlImage").on("input, change, keyup",(function(e){e.preventDefault();var t=$(this).val();t.length>0&&isValidHttpUrl(t)&&url2base64(t,(function(e){e.startsWith("data:image/")&&(preview(e),$("#image2up").val(e))}))})),$(".select2-brands").select2({placeholder:"Select a brand",width:null,ajax:{url:"/brand/fetch?only-enabled",dataType:"json",data:function(e){return{search:e.term}},processResults:function(e,t){var a=$.map(e,(function(e){return e.hasOwnProperty("brand_id")&&(e.text=`${e.brand_name} (${e.brand_generic})`,e.id=e.brand_id),e}));return{results:a}}}}),$(".select2-categories").select2({placeholder:"Select a category",width:null,ajax:{url:"/categories/fetch?only-enabled",dataType:"json",data:function(e){return{search:e.term}},processResults:function(e,t){var a=$.map(e,(function(e){return e.hasOwnProperty("brand_id")?(e.text=`${e.brand_name} (${e.brand_generic})`,e.id=e.brand_id):e.hasOwnProperty("categories_id")&&(e.text=e.categories_name,e.id=e.categories_id),e}));return{results:a}}}}),setTimeout(generateGenericNames,2500)})();