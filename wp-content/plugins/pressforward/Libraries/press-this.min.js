!function(H,I){I.wp=I.wp||{},I.wp.pressThis=new function(){var o,i,r,e,c=H(I),t=H(document),l=!1,s=!1,a=I.wpPressThisConfig||{},d=I.wpPressThisData||{},p=128,n=!1,u=[],h="is-off-screen",f="is-hidden",g=h+" "+f,m=/iPad|iPod|iPhone/.test(I.navigator.userAgent),v=H("#pressthis"),C=v[0],b=600,x=0,y=void 0!==(e=document.documentElement.style).transition?"transitionend":void 0!==e.WebkitTransition&&"webkitTransitionEnd";function w(e){return e&&I.pressThisL10n?I.pressThisL10n[e]||e:e||""}function k(e){return e=H.trim(e||""),/^(?:https?:)?\/\//.test(e)?(e=wp.sanitize.stripTags(e)).replace(/["\\]+/g,""):""}function T(e){var t;o&&!o.isHidden()||(e="reset"===e||x&&x>C.value.length,C.style.height,e?(t=I.pageYOffset,C.style.height="auto",C.style.height=Math.max(C.scrollHeight,b)+"px",I.scrollTo(I.pageXOffset,t)):parseInt(C.style.height,10)<C.scrollHeight&&(C.style.height=C.scrollHeight+"px"),x=C.value.length)}function E(e){var t=I.tinymce.util.VK,s=e.keyCode;s<=47&&s!==t.SPACEBAR&&s!==t.ENTER&&s!==t.DELETE&&s!==t.BACKSPACE&&s!==t.UP&&s!==t.LEFT&&s!==t.DOWN&&s!==t.UP||91<=s&&s<=93||112<=s&&s<=123||144===s||145===s||O(s)}function O(e){var t,s,a,n=function(){if(!o)return!1;var e,t,s,a=o.selection.getNode();if(o.wp&&o.wp.getView&&(t=o.wp.getView(a)))s=t.getBoundingClientRect();else{e=o.selection.getRng();try{s=e.getClientRects()[0]}catch(e){}s=s||a.getBoundingClientRect()}return!!s.height&&s}(),i=I.tinymce.util.VK;n&&(s=(t=n.top+o.iframeElement.getBoundingClientRect().top)+n.height,t-=50,s+=65,(a=c.height())<n.height||(t<0&&(e===i.UP||e===i.LEFT||e===i.BACKSPACE)?I.scrollTo(I.pageXOffset,t+I.pageYOffset):a<s&&I.scrollTo(I.pageXOffset,s+I.pageYOffset-a)))}function _(){var e=H("#title-container");return e.find("img.emoji").each(function(){var e=H(this);e.replaceWith(H("<span>").text(e.attr("alt")))}),wp.sanitize.stripTagsAndEncodeText(e.text())}function A(){var a=H("#pressthis-form"),n=H('<input type="hidden" name="post_category[]" value="">');o&&o.save(),H("#post_title").val(_()),I.tagBox&&H("div.tagsdiv").each(function(){I.tagBox.flushTags(this,!1,1)}),H(".categories-select .category").each(function(e,t){var s=H(t);s.hasClass("selected")&&a.append(n.clone().val(s.attr("data-term-id")||""))})}function D(e){var t;l=!1,H(".spinner").addClass("is-active"),H(".post-actions button").attr("disabled","disabled"),"publish"===e&&H("#post_status").val("publish"),A(),t=H("#pressthis-form").serialize(),H.ajax({type:"post",url:I.ajaxurl,data:t}).always(function(){H(".spinner").removeClass("is-active"),H(".post-actions button").removeAttr("disabled"),H("div.alerts").empty(),H(".publish-button").removeClass("is-saving")}).done(function(t){if(t.success){if(t.data.redirect)if(I.opener&&(a.redirInParent||t.data.force))try{I.opener.location.href=t.data.redirect,I.setTimeout(function(){I.self.close()},200)}catch(e){I.location.href=t.data.redirect}else I.location.href=t.data.redirect}else R(t.data.errorMessage)}).fail(function(){R(w("serverError"))})}function P(){var e,t=H("#new-category").val();t&&(e={action:"press-this-add-category",post_id:H("#post_ID").val()||0,name:t,new_cat_nonce:H("#_ajax_nonce-add-category").val()||"",parent:H("#new-category-parent").val()||0},H.post(I.ajaxurl,e,function(e){if(e.success){var a,n,i=H("ul.categories-select");H.each(e.data,function(e,t){var s=H("<li>").append(H('<div class="category selected" tabindex="0" role="checkbox" aria-checked="true">').attr("data-term-id",t.term_id).text(t.name));t.parent?(n&&n.length||(a=i.find('div[data-term-id="'+t.parent+'"]').parent(),(n=a.find("ul.children:first")).length||(n=H('<ul class="children">').appendTo(a))),n.prepend(s)):i.prepend(s),s.focus()}),z()}else R(e.data.errorMessage)}))}function B(e,t){var s=t?"is-error":"is-notice";H(".editor-wrapper div.alerts").append(H('<p class="alert '+s+'">').text(e))}function R(e){B(e,!0)}function j(){var n=0;i=H("ul.media-list"),r=H('<li class="suggested-media-thumbnail" tabindex="0"><span class="screen-reader-text"></span></li>'),d._embeds&&H.each(d._embeds,function(e,t){var s="",a=r.clone().addClass("is-embed");-1<(t=k(t)).indexOf("youtube.com/")?s="https://i.ytimg.com/vi/"+t.replace(/.+v=([^&]+).*/,"$1")+"/hqdefault.jpg":-1<t.indexOf("youtu.be/")?s="https://i.ytimg.com/vi/"+t.replace(/\/([^\/])$/,"$1")+"/hqdefault.jpg":-1<t.indexOf("dailymotion.com")?s=t.replace("/video/","/thumbnail/video/"):-1<t.indexOf("soundcloud.com")||t.indexOf("twitter.com"),a.attr("data-wp-src",t).find("span").text(w("suggestedEmbedAlt").replace("%d",e+1)),s&&a.css("background-image","url("+s+")"),i.append(a),n++}),d._images&&H.each(d._images,function(e,t){var s,a=new Image;t=k(t),s=t.replace(/^(http[^\?]+)(\?.*)?$/,"$1"),s=-1<t.indexOf("files.wordpress.com/")?s.replace(/\?.*$/,"")+"?w="+p:-1<t.indexOf("gravatar.com/")?s.replace(/\?.*$/,"")+"?s="+p:t,a.onload=function(){a.width&&a.width<256||a.height&&a.height<128||function(e,t,s){var a=r.clone().addClass("is-image");a.attr("data-wp-src",e).css("background-image","url("+t+")").find("span").text(w("suggestedImgAlt").replace("%d",s+1)),i.append(a)}(t,s,e)},a.src=t,n++}),n&&H(".media-list-container").addClass("has-media")}function L(){s=!1,H(".options").removeClass("open").addClass("closed"),H(".options-panel-back").addClass(f),H(".press-this-actions, #scanbar").removeClass(f),H(".options-panel").addClass(h).one(y,function(){H(this).addClass(f),H(".post-options").removeClass(g),H(".setting-modal").addClass(g)})}function N(){H(".split-button").removeClass("is-open"),H(".split-button-toggle").attr("aria-expanded","false")}function S(){d.hasData&&H("#scanbar").hide(),j(),d.errors&&H.each(d.errors,function(e,t){R(t)}),I.tagBox&&I.tagBox.init(),m&&H(document.body).css("cursor","pointer")}function $(){var a=H(".split-button");return t.on("tinymce-editor-init",function(e,t){(o=t).on("nodechange",function(){n=!0}),o.on("focus",function(){N()}),o.on("show",function(){setTimeout(function(){o.execCommand("wpAutoResize")},300)}),o.on("hide",function(){setTimeout(function(){T("reset")},100)}),o.on("keyup",E),o.on("undo redo",O)}).on("click.press-this keypress.press-this",".suggested-media-thumbnail",function(e){"click"!==e.type&&13!==e.keyCode||function(e){var t,s,a="";t=k(e.attr("data-wp-src")||""),s=k(d.u),a=e.hasClass("is-image")?'<a href="'+(s=s||t)+'"><img class="alignnone size-full" src="'+t+'" alt="" /></a>':"[embed]"+t+"[/embed]",o&&!o.isHidden()?n?o.execCommand("mceInsertContent",!1,a):o.setContent("<p>"+a+"</p>"+o.getContent()):I.QTags&&I.QTags.insertContent(a)}(H(this))}).on("click.press-this",function(e){H(e.target).closest("button").hasClass("split-button-toggle")||N()}),H(".post-actions").on("click.press-this",function(e){var t,s=H(e.target).closest("button");s.length&&(s.hasClass("draft-button")?(H(".publish-button").addClass("is-saving"),D("draft")):s.hasClass("publish-button")?(s.addClass("is-saving"),I.history.replaceState&&(t=I.location.href,t+=-1!==t.indexOf("?")?"&":"?",t+="wp-press-this-reload=true",I.history.replaceState(null,null,t)),D("publish")):s.hasClass("preview-button")?(A(),I.opener&&I.opener.focus(),H("#wp-preview").val("dopreview"),H("#pressthis-form").attr("target","_blank").submit().attr("target",""),H("#wp-preview").val("")):s.hasClass("standard-editor-button")?(H(".publish-button").addClass("is-saving"),H("#pt-force-redirect").val("true"),D("draft")):s.hasClass("split-button-toggle")&&(a.hasClass("is-open")?(a.removeClass("is-open"),s.attr("aria-expanded","false")):(a.addClass("is-open"),s.attr("aria-expanded","true"))))}),function(){var s=H(".post-options"),a=H(".post-option"),n=H(".setting-modal"),e=H(".modal-close");a.on("click",function(){var e=H(this).index(),t=n.eq(e);s.addClass(h).one(y,function(){H(this).addClass(f)}),t.removeClass(g).one(y,function(){H(this).find(".modal-close").focus()})}),e.on("click",function(){var e=H(this).parent(),t=e.index();s.removeClass(g),e.addClass(h),y?e.one(y,function(){H(this).addClass(f),a.eq(t-1).focus()}):setTimeout(function(){e.addClass(f),a.eq(t-1).focus()},350)})}(),function(){var n=H("#title-container"),e=H(".post-title-placeholder");n.on("focus",function(){e.addClass("is-hidden")}).on("blur",function(){n.text()||n.html()||e.removeClass("is-hidden")}).on("keyup",function(){l=!0}).on("paste",function(e){var t,s,a=e.originalEvent.clipboardData||I.clipboardData;if(a){try{(t=a.getData("Text")||a.getData("text/plain"))&&(t=H.trim(t.replace(/\s+/g," ")),I.getSelection?(s=I.getSelection().getRangeAt(0))&&(s.collapsed||s.deleteContents(),s.insertNode(document.createTextNode(t))):document.selection&&(s=document.selection.createRange())&&(s.text=t))}catch(e){}e.preventDefault()}l=!0,setTimeout(function(){n.text(_())},50)}),(n.text()||n.html())&&e.addClass("is-hidden")}(),H(".categories-select").on("click.press-this keydown.press-this",function(e){var t=H(e.target);if(t.is("div.category")){if("keydown"===e.type&&32!==e.keyCode)return;!function(e){e.hasClass("selected")?e.removeClass("selected").attr("aria-checked","false"):e.addClass("selected").attr("aria-checked","true")}(t),e.preventDefault()}}),H(".options").on("click.press-this",function(){H(this).hasClass("open")?L():(s=!0,H(".options").removeClass("closed").addClass("open"),H(".press-this-actions, #scanbar").addClass(f),H(".options-panel-back").removeClass(f),H(".options-panel").removeClass(g).one(y,function(){H(".post-option:first").focus()}))}),H(".options-panel, .options-panel-back").on("focusout.press-this",function(){setTimeout(function(){var e=document.activeElement,t=H(e);!s||!e||t.hasClass("options-panel-back")||"BODY"!==e.nodeName&&(t.closest(".options-panel").length||t.closest(".options").length)||L()},50)}),H("#post-formats-select input").on("change",function(){var e=H(this);e.is(":checked")&&H("#post-option-post-format").text(H('label[for="'+e.attr("id")+'"]').text()||"")}),c.on("beforeunload.press-this",function(){if(l||o&&o.isDirty())return w("saveAlert")}).on("resize.press-this",function(){o&&!o.isHidden()||T("reset")}),H("button.add-cat-toggle").on("click.press-this",function(){var e=H(this);e.toggleClass("is-toggled"),e.attr("aria-expanded","false"===e.attr("aria-expanded")?"true":"false"),H(".setting-modal .add-category, .categories-search-wrapper").toggleClass("is-hidden")}),H("button.add-cat-submit").on("click.press-this",P),H(".categories-search").on("keyup.press-this",function(){var s=H(this).val().toLowerCase()||"";/[\x20-\xFF]+/.test(s)&&s.length<2||(H.each(u,function(e,t){t.node.removeClass("is-hidden searched-parent")}),s&&H.each(u,function(e,t){-1===t.text.indexOf(s)?t.node.addClass("is-hidden"):t.parents.addClass("searched-parent")}))}),v.on("focus.press-this input.press-this propertychange.press-this",T),!0}function z(){H(".categories-select").find("li").each(function(){var e=H(this);u.push({node:e,parents:e.parents("li"),text:e.children(".category").text().toLowerCase()})})}return t.ready(function(){S(),$(),z()}),{renderNotice:B,renderError:R}}}(jQuery,window);