var tslib_1 = require("tslib");
// Generated by CoffeeScript 2.5.1
(function () {
    var JSONStorage, KEY_FOR_EMPTY_STRING, LocalStorage, MetaKey, QUOTA_EXCEEDED_ERR, StorageEvent, _emptyDirectory, _escapeKey, _rm, createMap, events, fs, path, writeSync;
    path = require('path');
    fs = require('fs');
    events = require('events');
    writeSync = require('write-file-atomic').sync;
    KEY_FOR_EMPTY_STRING = '---.EMPTY_STRING.---'; // Chose something that no one is likely to ever use
    _emptyDirectory = function (target) {
        var i, len, p, ref, results;
        ref = fs.readdirSync(target);
        results = [];
        for (i = 0, len = ref.length; i < len; i++) {
            p = ref[i];
            results.push(_rm(path.join(target, p)));
        }
        return results;
    };
    _rm = function (target) {
        if (fs.statSync(target).isDirectory()) {
            _emptyDirectory(target);
            return fs.rmdirSync(target);
        }
        else {
            return fs.unlinkSync(target);
        }
    };
    _escapeKey = function (key) {
        var newKey;
        if (key === '') {
            newKey = KEY_FOR_EMPTY_STRING;
        }
        else {
            newKey = key.toString();
        }
        return newKey;
    };
    QUOTA_EXCEEDED_ERR = /** @class */ (function (_super) {
        tslib_1.__extends(QUOTA_EXCEEDED_ERR, _super);
        function QUOTA_EXCEEDED_ERR(message) {
            if (message === void 0) { message = 'Unknown error.'; }
            var _this = _super.call(this) || this;
            _this.message = message;
            if (Error.captureStackTrace != null) {
                Error.captureStackTrace(_this, _this.constructor);
            }
            _this.name = _this.constructor.name;
            return _this;
        }
        QUOTA_EXCEEDED_ERR.prototype.toString = function () {
            return this.name + ": " + this.message;
        };
        return QUOTA_EXCEEDED_ERR;
    }(Error));
    StorageEvent = /** @class */ (function () {
        function StorageEvent(key1, oldValue1, newValue1, url, storageArea) {
            if (storageArea === void 0) { storageArea = 'localStorage'; }
            this.key = key1;
            this.oldValue = oldValue1;
            this.newValue = newValue1;
            this.url = url;
            this.storageArea = storageArea;
        }
        return StorageEvent;
    }());
    MetaKey = /** @class */ (function () {
        function MetaKey(key1, index1) {
            this.key = key1;
            this.index = index1;
            if (!(this instanceof MetaKey)) {
                return new MetaKey(this.key, this.index);
            }
        }
        return MetaKey;
    }());
    createMap = function () {
        var Map;
        Map = function () { };
        Map.prototype = Object.create(null);
        return new Map();
    };
    LocalStorage = (function () {
        var instanceMap;
        var LocalStorage = /** @class */ (function (_super) {
            tslib_1.__extends(LocalStorage, _super);
            function LocalStorage(_location, quota) {
                if (quota === void 0) { quota = 5 * 1024 * 1024; }
                var _this = this;
                var handler;
                _this = _super.call(this) || this;
                _this._location = _location;
                _this.quota = quota;
                // super(_location, quota)
                // @_location = _location
                // @quota = quota
                if (!(_this instanceof LocalStorage)) {
                    return new LocalStorage(_this._location, _this.quota);
                }
                _this._location = path.resolve(_this._location);
                if (instanceMap[_this._location] != null) {
                    return instanceMap[_this._location];
                }
                _this.length = 0; // !TODO: Maybe change this to a property with __defineProperty__
                _this._bytesInUse = 0;
                _this._keys = [];
                _this._metaKeyMap = createMap();
                _this._eventUrl = "pid:" + process.pid;
                _this._init();
                _this._QUOTA_EXCEEDED_ERR = QUOTA_EXCEEDED_ERR;
                if (typeof Proxy !== "undefined" && Proxy !== null) {
                    handler = {
                        set: function (receiver, key, value) {
                            if (_this[key] != null) {
                                return _this[key] = value;
                            }
                            else {
                                return _this.setItem(key, value);
                            }
                        },
                        get: function (receiver, key) {
                            if (_this[key] != null) {
                                return _this[key];
                            }
                            else {
                                return _this.getItem(key);
                            }
                        }
                    };
                    instanceMap[_this._location] = new Proxy(_this, handler);
                    return instanceMap[_this._location];
                }
                // else it'll return this
                instanceMap[_this._location] = _this;
                return instanceMap[_this._location];
            }
            LocalStorage.prototype._init = function () {
                var _MetaKey, _decodedKey, _keys, e, i, index, k, len, stat;
                try {
                    stat = fs.statSync(this._location);
                    if ((stat != null) && !stat.isDirectory()) {
                        throw new Error("A file exists at the location '" + this._location + "' when trying to create/open localStorage");
                    }
                    // At this point, it exists and is definitely a directory. So read it.
                    this._bytesInUse = 0;
                    this.length = 0;
                    _keys = fs.readdirSync(this._location);
                    for (index = i = 0, len = _keys.length; i < len; index = ++i) {
                        k = _keys[index];
                        _decodedKey = decodeURIComponent(k);
                        this._keys.push(_decodedKey);
                        _MetaKey = new MetaKey(k, index);
                        this._metaKeyMap[_decodedKey] = _MetaKey;
                        stat = this._getStat(k);
                        if ((stat != null ? stat.size : void 0) != null) {
                            _MetaKey.size = stat.size;
                            this._bytesInUse += stat.size;
                        }
                    }
                    this.length = _keys.length;
                }
                catch (error) {
                    e = error;
                    // If it errors, that might mean it didn't exist, so try to create it
                    if (e.code !== "ENOENT") {
                        throw e;
                    }
                    try {
                        fs.mkdirSync(this._location, {
                            recursive: true
                        });
                    }
                    catch (error) {
                        e = error;
                        if (e.code !== "EEXIST") {
                            throw e;
                        }
                    }
                }
            };
            LocalStorage.prototype.setItem = function (key, value) {
                var encodedKey, evnt, existsBeforeSet, filename, hasListeners, metaKey, oldLength, oldValue, valueString, valueStringLength;
                hasListeners = events.EventEmitter.listenerCount(this, 'storage');
                oldValue = null;
                if (hasListeners) {
                    oldValue = this.getItem(key);
                }
                key = _escapeKey(key);
                encodedKey = encodeURIComponent(key);
                filename = path.join(this._location, encodedKey);
                valueString = value.toString();
                valueStringLength = valueString.length;
                metaKey = this._metaKeyMap[key];
                existsBeforeSet = !!metaKey;
                if (existsBeforeSet) {
                    oldLength = metaKey.size;
                }
                else {
                    oldLength = 0;
                }
                if (this._bytesInUse - oldLength + valueStringLength > this.quota) {
                    throw new QUOTA_EXCEEDED_ERR();
                }
                writeSync(filename, valueString, 'utf8');
                if (!existsBeforeSet) {
                    metaKey = new MetaKey(encodedKey, (this._keys.push(key)) - 1);
                    metaKey.size = valueStringLength;
                    this._metaKeyMap[key] = metaKey;
                    this.length += 1;
                    this._bytesInUse += valueStringLength;
                }
                if (hasListeners) {
                    evnt = new StorageEvent(key, oldValue, value, this._eventUrl);
                    return this.emit('storage', evnt);
                }
            };
            LocalStorage.prototype.getItem = function (key) {
                var filename, metaKey;
                key = _escapeKey(key);
                metaKey = this._metaKeyMap[key];
                if (!!metaKey) {
                    filename = path.join(this._location, metaKey.key);
                    if (fs.existsSync(filename)) {
                        return fs.readFileSync(filename, 'utf8');
                    }
                    else {
                        return false;
                    }
                }
                else {
                    return null;
                }
            };
            LocalStorage.prototype._getStat = function (key) {
                var filename;
                key = _escapeKey(key);
                filename = path.join(this._location, encodeURIComponent(key));
                try {
                    return fs.statSync(filename);
                }
                catch (error) {
                    return null;
                }
            };
            LocalStorage.prototype.removeItem = function (key) {
                var evnt, filename, hasListeners, k, meta, metaKey, oldValue, ref, v;
                key = _escapeKey(key);
                metaKey = this._metaKeyMap[key];
                if (!!metaKey) {
                    hasListeners = events.EventEmitter.listenerCount(this, 'storage');
                    oldValue = null;
                    if (hasListeners) {
                        oldValue = this.getItem(key);
                    }
                    delete this._metaKeyMap[key];
                    this.length -= 1;
                    this._bytesInUse -= metaKey.size;
                    filename = path.join(this._location, metaKey.key);
                    this._keys.splice(metaKey.index, 1);
                    ref = this._metaKeyMap;
                    for (k in ref) {
                        v = ref[k];
                        meta = this._metaKeyMap[k];
                        if (meta.index > metaKey.index) {
                            meta.index -= 1;
                        }
                    }
                    _rm(filename);
                    if (hasListeners) {
                        evnt = new StorageEvent(key, oldValue, null, this._eventUrl);
                        return this.emit('storage', evnt);
                    }
                }
            };
            LocalStorage.prototype.key = function (n) {
                var rawKey;
                rawKey = this._keys[n];
                if (rawKey === KEY_FOR_EMPTY_STRING) {
                    return '';
                }
                else {
                    return rawKey;
                }
            };
            LocalStorage.prototype.clear = function () {
                var evnt;
                _emptyDirectory(this._location);
                this._metaKeyMap = createMap();
                this._keys = [];
                this.length = 0;
                this._bytesInUse = 0;
                if (events.EventEmitter.listenerCount(this, 'storage')) {
                    evnt = new StorageEvent(null, null, null, this._eventUrl);
                    return this.emit('storage', evnt);
                }
            };
            LocalStorage.prototype._getBytesInUse = function () {
                return this._bytesInUse;
            };
            LocalStorage.prototype._deleteLocation = function () {
                delete instanceMap[this._location];
                _rm(this._location);
                this._metaKeyMap = {};
                this._keys = [];
                this.length = 0;
                return this._bytesInUse = 0;
            };
            return LocalStorage;
        }(events.EventEmitter));
        ;
        instanceMap = {};
        return LocalStorage;
    }).call(this);
    JSONStorage = /** @class */ (function (_super) {
        tslib_1.__extends(JSONStorage, _super);
        function JSONStorage() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        JSONStorage.prototype.setItem = function (key, value) {
            var newValue;
            newValue = JSON.stringify(value);
            return _super.prototype.setItem.call(this, key, newValue);
        };
        JSONStorage.prototype.getItem = function (key) {
            return JSON.parse(_super.prototype.getItem.call(this, key));
        };
        return JSONStorage;
    }(LocalStorage));
    exports.LocalStorage = LocalStorage;
    exports.JSONStorage = JSONStorage;
    exports.QUOTA_EXCEEDED_ERR = QUOTA_EXCEEDED_ERR;
}).call(this);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTG9jYWxTdG9yYWdlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vbGlicy9zcmMvbm9kZS1sb2NhbHN0b3JhZ2UvTG9jYWxTdG9yYWdlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxrQ0FBa0M7QUFDbEMsQ0FBQztJQUNDLElBQUksV0FBVyxFQUFFLG9CQUFvQixFQUFFLFlBQVksRUFBRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsWUFBWSxFQUFFLGVBQWUsRUFBRSxVQUFVLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxTQUFTLENBQUM7SUFFekssSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUV2QixFQUFFLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRW5CLE1BQU0sR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7SUFFM0IsU0FBUyxHQUFHLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUU5QyxvQkFBb0IsR0FBRyxzQkFBc0IsQ0FBQyxDQUFDLG9EQUFvRDtJQUVuRyxlQUFlLEdBQUcsVUFBUyxNQUFNO1FBQy9CLElBQUksQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQztRQUM1QixHQUFHLEdBQUcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUM3QixPQUFPLEdBQUcsRUFBRSxDQUFDO1FBQ2IsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsR0FBRyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDMUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNYLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFF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