AjaxForm();var dataSource=[],clonedCol=null;function initializeSelect2(){jQuery("select.select2").each((function(e,t){var i=jQuery(this);if(i.attr("id")||i.attr("id",uniqid("select-")),!i.data("select2")){var a=jQuery(this).data("key");1==i.find("option").length?(i.select2({data:dataSource.filter(onlyUnique),theme:"material",placeholder:"Select a route",allowClear:!0}),a&&a.length&&!i.val()&&i.val(a).trigger("change")):i.select2({theme:"material",placeholder:"Select a role",allowClear:!0})}}))}function uinitializeSelect2(){jQuery("select.select2").each((function(e,t){var i=jQuery(this);i.data("select2")&&i.select2("destroy")}))}function buildData(e){uinitializeSelect2();var t=$("form#access-management").find("div[id^=Roles-]");t.length&&t.each((function(e,t){var i=$(this).find("select");if(i.length)for(let r=1;r<i.length;r++){var a=i[r];$(a).attr("name",`access[${i[0].value}][]`),a.setAttribute("name",`access[${i[0].value}][]`)}})),initializeSelect2()}jQuery(document).ready((function(){var e;load_module(["select2"],(function(){loadCSS("/assets/css/select2.min.css",(function(){$.ajax({url:"",method:"post",data:{getAccess:guid()},success:function(e){e&&Array.isArray(e)&&e.forEach((function(e,t){dataSource.push({text:e,id:e})})),initializeSelect2()}})}))})),$(document).on("mouseover mouseout",'[id^="Roles-"] button',(function(t){t.preventDefault();$(this),t.target;var i=t.type,a=t.target.getAttribute("id"),r=i+a;if(a&&e!=r){var l;if(uinitializeSelect2(),e!=r&&a)/^group-remove-/s.test(a)?(l=$(this).parents('[id^="Roles-"]'),"mouseover"==i?l.addClass("border border-danger"):l.removeClass("border-danger")):/^select-add-/s.test(a)?(l=$(this).parents('[id^="select-group-"]'),"mouseover"==i?l.addClass("border border-success"):l.removeClass("border-success border")):/^select-remove-/s.test(a)&&(l=$(this).parents('[id^="select-access-"]'),"mouseover"==i?l.addClass("border border-danger"):l.removeClass("border-danger border")),e=r;initializeSelect2()}})),$(document).on("click",'[id^="group-remove-"]',(function(e){e.preventDefault(),uinitializeSelect2();var t=$(this).parents("div[id^='Roles-']");t.length&&t.remove(),initializeSelect2()})),$(document).on("click",'[id^="select-add-"]',(function(e){e.preventDefault(),uinitializeSelect2();var t=$(this).parents("[id^='select-group-']"),i=t.find("[id^='select-access-']");if(i.length){var a=i[0].cloneNode(!0),r=a.querySelector("select");r.removeAttribute("data-key"),r.removeAttribute("name"),r.setAttribute("id",uniqid("Access-")),r.selectedIndex=null;var l=a.querySelector("button");l.setAttribute("id",uniqid("select-remove-")),t.prepend(a)}initializeSelect2()})),$(document).on("click",'[id^="select-remove-"]',(function(e){e.preventDefault(),uinitializeSelect2();var t=$(this).parents("[id^='select-access-']");t.length&&t.remove(),initializeSelect2()})),jQuery(document).on("change","select.select2",buildData),jQuery("#addAccess").click((function(e){e.preventDefault(),uinitializeSelect2();var t=jQuery('div[id^="Roles-"]');if(t.length){var i=t[0].cloneNode(!0);i.setAttribute("id",uniqid("Roles-")),$(i).find("select, button").not('[id^="select-remove-"]').not('[id^="select-add-"]').each((function(){var e=$(this).attr("id").toString().trim();e&&(e.includes("Access")?$(this).attr("id",uniqid("Access-")):$(this).attr("id",uniqid("Roles-"))),"SELECT"==$(this).prop("tagName")&&$(this).prop("selectedIndex",0).trigger("change")})),$("#access-wrapper")[0].appendChild(i)}initializeSelect2()}))}));