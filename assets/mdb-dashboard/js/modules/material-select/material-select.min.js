"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}jQuery((function(e){var t=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),this.options={destroy:this.fallback().or(a.destroy).or(!1).value(),validate:this.fallback().or(e.attr("data-validate")).or(a.validate).or(!1).value(),selectId:this.fallback().or(e.attr("data-native-id")).or(a.selectId).or(null).value(),defaultMaterialInput:this.fallback().or(e.attr("data-default-material-input")).or(a.defaultMaterialInput).or(!1).value(),fasClasses:this.fallback().or(e.attr("data-fas-classes")).or(a.fasClasses).or("").value(),farClasses:this.fallback().or(e.attr("data-far-classes")).or(a.farClasses).or("").value(),fabClasses:this.fallback().or(e.attr("data-fab-classes")).or(a.fabClasses).or("").value(),copyClassesOption:this.fallback().or(e.attr("data-copy-classes-option")).or(a.copyClassesOption).or(!1).value(),labels:{selectAll:this.fallback().or(e.attr("data-label-select-all")).or((a.labels||{}).selectAll).or("Select all").value(),optionsSelected:this.fallback().or(e.attr("data-label-options-selected")).or((a.labels||{}).optionsSelected).or("options selected").value(),validFeedback:this.fallback().or(e.attr("data-label-valid-feedback")).or((a.labels||{}).validFeedback).or("Ok").value(),invalidFeedback:this.fallback().or(e.attr("data-label-invalid-feedback")).or((a.labels||{}).invalidFeedback).or("Incorrect value").value(),noSearchResults:this.fallback().or(e.attr("data-label-no-search-results")).or((a.labels||{}).noSearchResults).or("No results").value()},keyboardActiveClass:this.fallback().or(e.attr("data-keyboard-active-class")).or(a.keyboardActiveClass).or("heavy-rain-gradient").value(),placeholder:this.fallback().or(e.attr("data-placeholder")).or(a.placeholder).or(null).value(),visibleOptions:this.fallback().or(e.attr("data-visible-options")).or(a.visibleOptions).or(5).value(),maxSelectedOptions:this.fallback().or(e.attr("data-max-selected-options")).or(a.maxSelectedOptions).or(5).value()},this.uuid=e.attr("id")||this.options.selectId||this._randomUUID(),this.view=new MaterialSelectView(e,{options:this.options,properties:{id:this.uuid}}),this.selectedOptionsIndexes=[],t.mutationObservers=[]}return _createClass(t,[{key:"init",value:function(){var e=this;this.options.destroy?this.view.destroy():(this.isInitialized&&this.view.destroy(),this.view.render(),this.view.selectPreselectedOptions((function(t){return e._toggleSelectedValue(t)})),this.bindEvents())}},{key:"bindEvents",value:function(){var e=this;this.bindMutationObserverChange(),this.view.bindMaterialSelectFocus(),this.view.bindMaterialSelectClick(),this.view.bindMaterialSelectBlur(),this.view.bindMaterialSelectKeydown(),this.view.bindMaterialSelectDropdownToggle(),this.view.bindToggleAllClick((function(t){return e._toggleSelectedValue(t)})),this.view.bindMaterialOptionMousedown(),this.view.bindMaterialOptionClick((function(t){return e._toggleSelectedValue(t)})),!this.view.isMultiple&&this.view.isSearchable&&this.view.bindSingleMaterialOptionClick(),this.view.isSearchable&&this.view.bindSearchInputKeyup(),this.view.bindHtmlClick(),this.view.bindMobileDevicesMousedown(),this.view.bindSaveBtnClick()}},{key:"bindMutationObserverChange",value:function(){var e={attributes:!0,childList:!0,characterData:!0,subtree:!0},a=new MutationObserver(this._onMutationObserverChange.bind(this));a.observe(this.view.$nativeSelect.get(0),e),a.customId=this.uuid,a.customStatus="observing",t.clearMutationObservers(),t.mutationObservers.push(a)}},{key:"_onMutationObserverChange",value:function(a){a.forEach((function(a){var i=e(a.target).closest("select");!0!==i.data("stop-refresh")&&("childList"===a.type||"attributes"===a.type&&e(a.target).is("option"))&&(t.clearMutationObservers(),i.materialSelect({destroy:!0}),i.materialSelect())}))}},{key:"_toggleSelectedValue",value:function(e){var t=this.selectedOptionsIndexes.indexOf(e),a=-1!==t;return a?this.selectedOptionsIndexes.splice(t,1):this.selectedOptionsIndexes.push(e),this.view.$nativeSelect.find("option").eq(e).prop("selected",!a),this._setValueToMaterialSelect(),!a}},{key:"_setValueToMaterialSelect",value:function(){var e=this,t="",a=this.selectedOptionsIndexes.length;this.selectedOptionsIndexes.forEach((function(a){return t+=", ".concat(e.view.$nativeSelect.find("option").eq(a).text().replace(/  +/g," ").trim())})),t=this.options.maxSelectedOptions>=0&&a>this.options.maxSelectedOptions?"".concat(a," ").concat(this.options.labels.optionsSelected):t.substring(2),0===t.length&&(t=this.view.$nativeSelect.find("option:disabled").eq(0).text()),this.view.$nativeSelect.siblings("".concat(this.options.defaultMaterialInput?"input.multi-bs-select":"input.select-dropdown")).val(t)}},{key:"_randomUUID",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:3&a|8).toString(16)}))}},{key:"fallback",value:function(){return{_value:void 0,or:function(e){return"undefined"!==typeof e&&"undefined"===typeof this._value&&(this._value=e),this},value:function(){return this._value}}}},{key:"isInitialized",get:function(){return Boolean(this.view.$nativeSelect.data("select-id"))&&this.view.$nativeSelect.hasClass("initialized")}}],[{key:"clearMutationObservers",value:function(){t.mutationObservers.forEach((function(e){e.disconnect(),e.customStatus="stopped"}))}}]),t}();e.fn.materialSelect=function(a){e(this).not(".browser-default").not(".custom-select").each((function(){var i=new t(e(this),a);i.init()}))},function(a){e.fn.val=function(e){if(!arguments.length)return a.call(this);if(!0!==this.data("stop-refresh")&&this.hasClass("mdb-select")&&this.hasClass("initialized")){t.clearMutationObservers(),this.materialSelect({destroy:!0});var i=a.call(this,e);return this.materialSelect(),i}return a.call(this,e)}}(e.fn.val)}));