(function(){var t=window.jQuery,i=t(window),e=t(document),s="http://www.w3.org/2000/svg",o="SVGAngle"in window&&function(){var t,i=document.createElement("div");return i.innerHTML="<svg/>",t=(i.firstChild&&i.firstChild.namespaceURI)==s,i.innerHTML="",t}(),n=function(){var t=document.createElement("div").style;return"transition"in t||"WebkitTransition"in t||"MozTransition"in t||"msTransition"in t||"OTransition"in t}(),c="ontouchstart"in window,r="mousedown"+(c?" touchstart":""),a="mousemove.clockpicker"+(c?" touchmove.clockpicker":""),p="mouseup.clockpicker"+(c?" touchend.clockpicker":""),h=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null;function l(t){return document.createElementNS(s,t)}function u(t,i,e){var s;return function(){var o=this,n=arguments,c=function(){s=null,e||t.apply(o,n)},r=e&&!s;clearTimeout(s),s=setTimeout(c,i),r&&t.apply(o,n)}}function d(t){return(t<10?"0":"")+t}var m=0;function k(t){var i=++m+"";return t?t+i:i}var v=135,f=110,b=80,g=20,w=2*v,y=n?350:1,A=['<div class="clockpicker picker">','<div class="picker__holder">','<div class="picker__frame">','<div class="picker__wrap">','<div class="picker__box">','<div class="picker__date-display">','<div class="clockpicker-display">','<div class="clockpicker-display-column">','<span class="clockpicker-span-hours text-primary"></span>',":",'<span class="clockpicker-span-minutes"></span>',"</div>",'<div class="clockpicker-display-column clockpicker-display-am-pm">','<div class="clockpicker-span-am-pm"></div>',"</div>","</div>","</div>",'<div class="picker__calendar-container">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<div class="clockpicker-am-pm-block">',"</div>","</div>",'<div class="picker__footer">',"</div>","</div>","</div>","</div>","</div>","</div>"].join("");function M(i,s){var n=t(A),c=n.find(".clockpicker-plate"),h=n.find(".picker__holder"),m=n.find(".clockpicker-hours"),M=n.find(".clockpicker-minutes"),C=n.find(".clockpicker-am-pm-block"),T="INPUT"===i.prop("tagName"),x=T?i:i.find("input"),V=(x.prop("type"),t("label[for="+x.attr("id")+"]")),_=this;if(this.id=k("cp"),this.element=i,this.holder=h,this.options=s,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=T,this.input=x,this.label=V,this.popover=n,this.plate=c,this.hoursView=m,this.minutesView=M,this.amPmBlock=C,this.spanHours=n.find(".clockpicker-span-hours"),this.spanMinutes=n.find(".clockpicker-span-minutes"),this.spanAmPm=n.find(".clockpicker-span-am-pm"),this.footer=n.find(".picker__footer"),this.amOrPm="",s.twelvehour){var H=['<div class="clockpicker-am-pm-block">','<button type="button" class="btn-floating btn-flat clockpicker-button clockpicker-am-button">',"AM","</button>",'<button type="button" class="btn-floating btn-flat clockpicker-button clockpicker-pm-button">',"PM","</button>","</div>"].join("");t(H);s.ampmclickable?(this.spanAmPm.empty(),t('<div id="click-am">AM</div>').on("click",(function(){_.spanAmPm.children("#click-am").addClass("text-primary"),_.spanAmPm.children("#click-pm").removeClass("text-primary"),_.amOrPm="AM"})).appendTo(this.spanAmPm),t('<div id="click-pm">PM</div>').on("click",(function(){_.spanAmPm.children("#click-pm").addClass("text-primary"),_.spanAmPm.children("#click-am").removeClass("text-primary"),_.amOrPm="PM"})).appendTo(this.spanAmPm)):(t('<button type="button" class="btn-floating btn-flat clockpicker-button am-button" tabindex="1">AM</button>').on("click",(function(){_.amOrPm="AM",_.amPmBlock.children(".pm-button").removeClass("active"),_.amPmBlock.children(".am-button").addClass("active"),_.spanAmPm.empty().append("AM")})).appendTo(this.amPmBlock),t('<button type="button" class="btn-floating btn-flat clockpicker-button pm-button" tabindex="2">PM</button>').on("click",(function(){_.amOrPm="PM",_.amPmBlock.children(".am-button").removeClass("active"),_.amPmBlock.children(".pm-button").addClass("active"),_.spanAmPm.empty().append("PM")})).appendTo(this.amPmBlock))}s.darktheme&&n.addClass("darktheme"),t('<button type="button" class="btn btn-flat clockpicker-button" tabindex="'+(s.twelvehour?"3":"1")+'">'+s.donetext+"</button>").click(t.proxy(this.done,this)).appendTo(this.footer),t('<button type="button" class="btn btn-flat clockpicker-button" tabindex="'+(s.twelvehour?"4":"2")+'">'+s.cleartext+"</button>").click(t.proxy(this.clearInput,this)).appendTo(this.footer),this.spanHours.click(t.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(t.proxy(this.toggleView,this,"minutes")),x.on("click.clockpicker",u(t.proxy(this.show,this),100));var D,S,I,B,O=t('<div class="clockpicker-tick"></div>');if(s.twelvehour)for(D=0;D<12;D+=s.hourstep)S=O.clone(),I=D/6*Math.PI,B=f,S.css("font-size","140%"),S.css({left:v+Math.sin(I)*B-g,top:v-Math.cos(I)*B-g}),S.html(0===D?12:D),m.append(S),S.on(r,z);else for(D=0;D<24;D+=s.hourstep){S=O.clone(),I=D/6*Math.PI;var E=D>0&&D<13;B=E?b:f,S.css({left:v+Math.sin(I)*B-g,top:v-Math.cos(I)*B-g}),E&&S.css("font-size","120%"),S.html(0===D?"00":D),m.append(S),S.on(r,z)}var L=Math.max(s.minutestep,5);for(D=0;D<60;D+=L)for(D=0;D<60;D+=5)S=O.clone(),I=D/30*Math.PI,S.css({left:v+Math.sin(I)*f-g,top:v-Math.cos(I)*f-g}),S.css("font-size","140%"),S.html(d(D)),M.append(S),S.on(r,z);function z(t,i){var n=c.offset(),r=/^touch/.test(t.type),h=n.left+v,l=n.top+v,u=(r?t.originalEvent.touches[0]:t).pageX-h,d=(r?t.originalEvent.touches[0]:t).pageY-l,m=Math.sqrt(u*u+d*d),k=!1;if(!i||!(m<f-g||m>f+g)){t.preventDefault();var b=setTimeout((function(){_.popover.addClass("clockpicker-moving")}),200);o&&c.append(_.canvas),_.setHand(u,d,!i,!0),e.off(a).on(a,(function(t){t.preventDefault();var i=/^touch/.test(t.type),e=(i?t.originalEvent.touches[0]:t).pageX-h,s=(i?t.originalEvent.touches[0]:t).pageY-l;(k||e!==u||s!==d)&&(k=!0,_.setHand(e,s,!1,!0))})),e.off(p).on(p,(function(t){e.off(p),t.preventDefault();var o=/^touch/.test(t.type),n=(o?t.originalEvent.changedTouches[0]:t).pageX-h,r=(o?t.originalEvent.changedTouches[0]:t).pageY-l;(i||k)&&n===u&&r===d&&_.setHand(n,r),"hours"===_.currentView?_.toggleView("minutes",y/2):s.autoclose&&(_.minutesView.addClass("clockpicker-dial-out"),setTimeout((function(){_.done()}),y/2)),c.prepend(j),clearTimeout(b),_.popover.removeClass("clockpicker-moving"),e.off(a)}))}}if(c.on(r,(function(i){0===t(i.target).closest(".clockpicker-tick").length&&z(i,!0)})),o){var j=n.find(".clockpicker-canvas"),U=l("svg");U.setAttribute("class","clockpicker-svg"),U.setAttribute("width",w),U.setAttribute("height",w);var N=l("g");N.setAttribute("transform","translate("+v+","+v+")");var X=l("circle");X.setAttribute("class","clockpicker-canvas-bearing"),X.setAttribute("cx",0),X.setAttribute("cy",0),X.setAttribute("r",2);var Y=l("line");Y.setAttribute("x1",0),Y.setAttribute("y1",0);var q=l("circle");q.setAttribute("class","clockpicker-canvas-bg"),q.setAttribute("r",g);var F=l("circle");F.setAttribute("class","clockpicker-canvas-fg"),F.setAttribute("r",5),N.appendChild(Y),N.appendChild(q),N.appendChild(F),N.appendChild(X),U.appendChild(N),j.append(U),this.hand=Y,this.bg=q,this.fg=F,this.bearing=X,this.g=N,this.canvas=j}P(this.options.init)}function P(t){t&&"function"===typeof t&&t()}M.DEFAULTS={default:"",fromnow:0,donetext:"Done",cleartext:"Clear",autoclose:!1,ampmclickable:!1,darktheme:!1,twelvehour:!1,vibrate:!0,hourstep:1,minutestep:1,ampmSubmit:!1,container:"body"},M.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},M.prototype.locate=function(){var i=this.element;t(this.options.container).append(this.popover),i.offset(),i.outerWidth(),i.outerHeight(),this.options.align;this.popover.show()},M.prototype.parseInputValue=function(){var t=this.input.prop("value")||this.options["default"]||"";if("now"===t&&(t=new Date(+new Date+this.options.fromnow)),t instanceof Date&&(t=t.getHours()+":"+t.getMinutes()),t=t.split(":"),this.hours=+t[0]||0,this.minutes=+(t[1]+"").replace(/\D/g,"")||0,this.hours=Math.round(this.hours/this.options.hourstep)*this.options.hourstep,this.minutes=Math.round(this.minutes/this.options.minutestep)*this.options.minutestep,this.options.twelvehour){var i=(t[1]+"").replace(/\d+/g,"").toLowerCase();this.amOrPm=this.hours>12||"pm"===i?"PM":"AM"}},M.prototype.show=function(s){if(!this.isShown){P(this.options.beforeShow),t(":input").each((function(){t(this).attr("tabindex",-1)}));var o=this;this.input.blur(),this.popover.addClass("picker--opened"),this.input.addClass("picker__input picker__input--active"),t(document.body).css("overflow","hidden"),this.isAppended||(this.popover.insertAfter(this.input),this.options.twelvehour&&(this.amOrPm="PM",this.options.ampmclickable?(this.spanAmPm.children("#click-pm").addClass("text-primary"),this.spanAmPm.children("#click-am").removeClass("text-primary")):(this.amPmBlock.children(".am-button").removeClass("active"),this.amPmBlock.children(".pm-button").addClass("active"),this.spanAmPm.empty().append("PM"))),i.on("resize.clockpicker"+this.id,(function(){o.isShown&&o.locate()})),this.isAppended=!0),this.parseInputValue(),this.spanHours.html(d(this.hours)),this.spanMinutes.html(d(this.minutes)),this.options.twelvehour&&this.spanAmPm.empty().append(this.amOrPm),this.toggleView("hours"),this.locate(),this.isShown=!0,e.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,u((function(i){var e=t(i.target);0===e.closest(o.popover.find(".picker__wrap")).length&&0===e.closest(o.input).length&&o.hide()}),100)),e.on("keyup.clockpicker."+this.id,u((function(t){27===t.keyCode&&o.hide()}),100)),P(this.options.afterShow)}},M.prototype.hide=function(){P(this.options.beforeHide),this.input.removeClass("picker__input picker__input--active"),this.popover.removeClass("picker--opened"),t(document.body).css("overflow","visible"),this.isShown=!1,t(":input").each((function(i){t(this).attr("tabindex",i+1)})),e.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),e.off("keyup.clockpicker."+this.id),this.popover.hide(),P(this.options.afterHide)},M.prototype.toggleView=function(i,e){var s=!1;"minutes"===i&&"visible"===t(this.hoursView).css("visibility")&&(P(this.options.beforeHourSelect),s=!0);var o="hours"===i,n=o?this.hoursView:this.minutesView,c=o?this.minutesView:this.hoursView;this.currentView=i,this.spanHours.toggleClass("text-primary",o),this.spanMinutes.toggleClass("text-primary",!o),c.addClass("clockpicker-dial-out"),n.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(e),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout((function(){c.css("visibility","hidden")}),y),s&&P(this.options.afterHourSelect)},M.prototype.resetClock=function(t){var i=this.currentView,e=this[i],s="hours"===i,n=Math.PI/(s?6:30),c=e*n,r=s&&e>0&&e<13?b:f,a=Math.sin(c)*r,p=-Math.cos(c)*r,h=this;o&&t?(h.canvas.addClass("clockpicker-canvas-out"),setTimeout((function(){h.canvas.removeClass("clockpicker-canvas-out"),h.setHand(a,p)}),t)):this.setHand(a,p)},M.prototype.setHand=function(i,e,s,n){var c,r,a=Math.atan2(i,-e),p="hours"===this.currentView,l=Math.sqrt(i*i+e*e),u=this.options,m=p&&l<(f+b)/2,k=m?b:f;if(c=p?u.hourstep/6*Math.PI:u.minutestep/30*Math.PI,u.twelvehour&&(k=f),a<0&&(a=2*Math.PI+a),r=Math.round(a/c),a=r*c,p?(r*=u.hourstep,u.twelvehour||!m!=r>0||(r+=12),u.twelvehour&&0===r&&(r=12),24===r&&(r=0)):(r*=u.minutestep,60===r&&(r=0)),p||r%5==0?this.fg.setAttribute("class","clockpicker-canvas-fg"):this.fg.setAttribute("class","clockpicker-canvas-fg active"),this[this.currentView]!==r&&h&&this.options.vibrate&&(this.vibrateTimer||(navigator[h](10),this.vibrateTimer=setTimeout(t.proxy((function(){this.vibrateTimer=null}),this),100))),this[this.currentView]=r,this[p?"spanHours":"spanMinutes"].html(d(r)),o){n||!p&&r%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg"));var v=Math.sin(a)*k,g=-Math.cos(a)*k;this.hand.setAttribute("x2",v),this.hand.setAttribute("y2",g),this.bg.setAttribute("cx",v),this.bg.setAttribute("cy",g),this.fg.setAttribute("cx",v),this.fg.setAttribute("cy",g)}else this[p?"hoursView":"minutesView"].find(".clockpicker-tick").each((function(){var i=t(this);i.toggleClass("active",r===+i.html())}))},M.prototype.clearInput=function(){this.input.val(""),this.hide(),this.options.afterDone&&"function"===typeof this.options.afterDone&&this.options.afterDone(this.input,null)},M.prototype.getTime=function(t){this.parseInputValue();var i=this.hours;this.options.twelvehour&&i<12&&"PM"===this.amOrPm&&(i+=12);var e=new Date;return e.setMinutes(this.minutes),e.setHours(i),e.setSeconds(0),t&&t.apply(this.element,e)||e},M.prototype.done=function(){P(this.options.beforeDone),this.hide(),this.label.addClass("active");var t=this.input.prop("value"),i=this.hours,e=":"+d(this.minutes);this.isHTML5&&this.options.twelvehour&&(this.hours<12&&"PM"===this.amOrPm&&(i+=12),12===this.hours&&"AM"===this.amOrPm&&(i=0)),e=d(i)+e,!this.isHTML5&&this.options.twelvehour&&(e+=this.amOrPm),this.input.prop("value",e),e!==t&&(this.input.trigger("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur"),P(this.options.afterDone)},M.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(i.off("resize.clockpicker"+this.id),this.popover.remove())},t.fn.pickatime=function(i){var e=Array.prototype.slice.call(arguments,1);function s(){var s=t(this),o=s.data("clockpicker");if(o)"function"===typeof o[i]&&o[i].apply(o,e);else{var n=t.extend({},M.DEFAULTS,s.data(),"object"==typeof i&&i);s.data("clockpicker",new M(s,n))}}if(1==this.length){var o=s.apply(this[0]);return void 0!==o?o:this}return this.each(s)}})();