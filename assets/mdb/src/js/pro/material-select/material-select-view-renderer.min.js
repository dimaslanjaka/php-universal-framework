export default class MaterialSelectViewRenderer{constructor(e){this.view=e}get shouldValidate(){return this.view.options.validate}get shouldInheritTabindex(){return!1!==this.view.$nativeSelect.data("inherit-tabindex")}get isMultiple(){return this.view.isMultiple}get isSearchable(){return this.view.isSearchable}get isRequired(){return this.view.isRequired}get isEditable(){return this.view.isEditable}get isDisabled(){return this.view.isDisabled}get isDefaultMaterialInput(){return this.view.options.defaultMaterialInput}get isCustomSelect(){return this.view.$materialSelect.hasClass("custom-select")&&this.view.$materialSelect.hasClass("select-dropdown")}destroy(){const e=this.view.$nativeSelect.data("select-id");this.view.$nativeSelect.data("select-id",null).removeClass("initialized"),this.view.$nativeSelect.parent().find("span.caret").remove(),this.view.$nativeSelect.parent().find("input").remove(),this.view.$nativeSelect.unwrap(),$("ul#select-options-"+e).remove()}render(){this.setWrapperClasses(),this.setMaterialSelectInitialValue(),this.view.$nativeSelect.data("select-id",this.view.properties.id),this.view.$nativeSelect.before(this.view.$selectWrapper),this.view.options.showResetButton&&this.appendResetButton(),this.appendDropdownIcon(),this.appendMaterialSelect(),this.appendMaterialOptionsList(),this.appendNativeSelect(),this.appendSelectLabel(),this.appendCustomTemplateParts(),this.shouldValidate&&this.appendValidationFeedbackElements(),this.isRequired&&this.enableValidation(),this.isDisabled||(this.setMaterialOptionsListMaxHeight(),this.view.dropdown=this.view.$materialSelect.dropdown({hover:!1,closeOnClick:!1,resetScroll:!1})),this.shouldInheritTabindex&&this.view.$materialSelect.attr("tabindex",this.view.$nativeSelect.attr("tabindex")),this.isDefaultMaterialInput&&this.view.$mainLabel.css("top","-7px"),this.isCustomSelect&&this.view.$materialSelect.css({display:"inline-block",width:"100%",height:"calc(1.5em + .75rem + 2px)",padding:".375rem 1.75rem .375rem .75rem",fontSize:"1rem",lineHeight:"1.5",backgroundColor:"#fff",border:"1px solid #ced4da"}),this.addAccessibilityAttributes(),this.markInitialized()}setWrapperClasses(){this.isDefaultMaterialInput?this.view.$selectWrapper.addClass(this.view.$nativeSelect.attr("class").split(" ").filter(e=>"md-form"!==e).join(" ")).css({marginTop:"1.5rem",marginBottom:"1.5rem"}):this.view.$selectWrapper.addClass(this.view.$nativeSelect.attr("class"))}setMaterialSelectInitialValue(){if(this.view.options.placeholder)this.view.$materialSelect.attr("placeholder",this.view.options.placeholder),this.view.$nativeSelect.find('option[value=""][selected][disabled][data-mdb-placeholder]').length||this.view.$nativeSelect.prepend('<option value="" selected disabled data-mdb-placeholder></option>');else{const e=this.view.$materialSelectInitialOption.replace(/"/g,"&quot;").replace(/  +/g," ").trim();this.view.$materialSelect.val(e)}}appendDropdownIcon(){this.isDisabled&&this.view.$dropdownIcon.addClass("disabled"),this.view.$selectWrapper.append(this.view.$dropdownIcon)}appendResetButton(){this.isDisabled&&this.view.$btnReset.addClass("disabled"),-1===this.view.$nativeSelect.get(0).selectedIndex&&this.view.$btnReset.hide(),this.view.$selectWrapper.append(this.view.$btnReset)}appendMaterialSelect(){this.view.$selectWrapper.append(this.view.$materialSelect)}appendMaterialOptionsList(){this.isSearchable&&this.appendSearchInputOption(),this.isEditable&&this.isSearchable&&this.appendAddOptionBtn(),this.buildMaterialOptions(),this.isMultiple&&this.appendToggleAllCheckbox(),this.view.$selectWrapper.append(this.view.$materialOptionsList)}appendNativeSelect(){this.view.$nativeSelect.appendTo(this.view.$selectWrapper)}appendSelectLabel(){(this.view.$materialSelect.val()||this.view.options.placeholder)&&this.view.$mainLabel.addClass("active"),this.view.$mainLabel[this.isDisabled?"addClass":"removeClass"]("disabled"),this.view.$mainLabel.appendTo(this.view.$selectWrapper)}appendCustomTemplateParts(){this.view.$customTemplateParts.each((e,i)=>{const t=$(i);t.appendTo(this.view.$materialOptionsList).wrap("<li></li>")}),this.view.$btnSave.appendTo(this.view.$materialOptionsList)}appendValidationFeedbackElements(){this.view.$validFeedback.insertAfter(this.view.$selectWrapper),this.view.$invalidFeedback.insertAfter(this.view.$selectWrapper)}enableValidation(){this.view.$nativeSelect.css({position:"absolute",top:"1rem",left:"0",height:"0",width:"0",opacity:"0",padding:"0","pointer-events":"none"}),-1===this.view.$nativeSelect.attr("style").indexOf("inline!important")&&this.view.$nativeSelect.attr("style",this.view.$nativeSelect.attr("style")+" display: inline!important;"),this.view.$nativeSelect.attr("tabindex",-1),this.view.$nativeSelect.data("inherit-tabindex",!1)}setMaterialOptionsListMaxHeight(){const e=$("<div />").appendTo($("body"));e.css({position:"absolute !important",visibility:"hidden !important",display:"block !important"}),this.view.$materialOptionsList.show();const i=this.view.$materialOptionsList.clone().appendTo(e),t=this.view.options.visibleOptions;let a=0;const s=i.find("li").not(".disabled"),l=s.first().height(),n=s.length;if(this.isSearchable&&(a+=this.view.$searchInput.height()),this.isMultiple&&(a+=this.view.$toggleAll.height()),this.view.$materialOptionsList.hide(),e.remove(),t>=0&&t<n){const e=l*t+a;this.view.$materialOptionsList.css("max-height",e),this.view.$materialSelect.data("maxheight",e)}}addAccessibilityAttributes(){this.view.$materialSelect.attr({role:this.isSearchable?"combobox":"listbox","aria-multiselectable":this.isMultiple,"aria-disabled":this.isDisabled,"aria-required":this.isRequired,"aria-labelledby":this.view.$mainLabel.attr("id"),"aria-haspopup":!0,"aria-expanded":!1}),this.view.$searchInput&&this.view.$searchInput.attr("role","searchbox"),this.view.$materialOptionsList.find("li").each((function(){const e=$(this);e.attr({role:"option","aria-selected":e.hasClass("active"),"aria-disabled":e.hasClass("disabled")})}))}markInitialized(){this.view.$nativeSelect.addClass("initialized")}appendSearchInputOption(){const e=this.view.$nativeSelect.attr("searchable"),i=this.isDefaultMaterialInput?"":"md-form",t=this.isDefaultMaterialInput?"select-default mb-2":"";this.view.$searchInput=$(`<span class="search-wrap ml-2"><div class="${i} mt-0"><input type="text" class="search w-100 d-block ${t}" tabindex="-1" placeholder="${e}"></div></span>`),this.view.$materialOptionsList.append(this.view.$searchInput),this.view.$searchInput.on("click",e=>e.stopPropagation())}appendAddOptionBtn(){this.view.$searchInput.append(this.view.$addOptionBtn)}buildMaterialOptions(){this.view.$nativeSelectChildren.each((e,i)=>{const t=$(i);if(t.is("option"))this.buildSingleOption(t,this.isMultiple?"multiple":"");else if(t.is("optgroup")){const e=$(`<li class="optgroup"><span>${t.attr("label")}</span></li>`);this.view.$materialOptionsList.append(e);const i=t.children("option");i.each((e,i)=>{this.buildSingleOption($(i),"optgroup-option")})}})}appendToggleAllCheckbox(){const e=this.view.$materialOptionsList.find("li").first();e.hasClass("disabled")&&e.find("input").prop("disabled")?e.after(this.view.$toggleAll):this.view.$materialOptionsList.find("li").first().before(this.view.$toggleAll)}addNewOption(){const e=this.view.$searchInput.find("input").val(),i=$(`<option value="${e.toLowerCase()}" selected>${e}</option>`).prop("selected",!0);this.isMultiple||this.view.$nativeSelectChildren.each((e,i)=>{$(i).attr("selected",!1)}),this.view.$nativeSelect.append(i)}buildSingleOption(e,i){const t=e.is(":disabled")?"disabled":"",a=e.is(":selected")?"active":"",s="optgroup-option"===i?"optgroup-option":"",l=e.data("icon"),n=e.data("fas")?`<i class="fa-pull-right m-2 fas fa-${e.data("fas")} ${this.view.options.fasClasses}"></i> `:"",p=e.data("far")?`<i class="fa-pull-right m-2 far fa-${e.data("far")} ${this.view.options.farClasses}"></i> `:"",r=e.data("fab")?`<i class="fa-pull-right m-2 fab fa-${e.data("fab")} ${this.view.options.fabClasses}"></i> `:"",d=e.attr("class"),h=l?`<img alt="" src="${l}" class="${d}">`:"",o=this.isMultiple?`<input type="checkbox" class="form-check-input" ${t}/><label></label>`:"",c=e.data("secondary-text")?`<p class="text-muted pt-0 mb-0" disabled>${e.data("secondary-text")}</p>`:"";this.view.$materialOptionsList.append($(`<li class="${t} ${a} ${s} ${this.view.options.copyClassesOption?d:""} ">${h}<span class="filtrable">${o} ${e.html()} ${n} ${p} ${r} ${c}</span></li>`))}}