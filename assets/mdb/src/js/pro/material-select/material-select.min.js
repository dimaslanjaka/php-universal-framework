import MaterialSelectView from"./material-select-view";jQuery(e=>{class t{constructor(e,i={}){this.options={destroy:this.fallback().or(i.destroy).or(!1).value(),validate:this.fallback().or(e.attr("data-validate")).or(i.validate).or(!1).value(),selectId:this.fallback().or(e.attr("data-select-id")).or(i.selectId).or(null).value(),defaultMaterialInput:this.fallback().or(e.attr("data-default-material-input")).or(i.defaultMaterialInput).or(!1).value(),fasClasses:this.fallback().or(e.attr("data-fas-classes")).or(i.fasClasses).or("").value(),farClasses:this.fallback().or(e.attr("data-far-classes")).or(i.farClasses).or("").value(),fabClasses:this.fallback().or(e.attr("data-fab-classes")).or(i.fabClasses).or("").value(),copyClassesOption:this.fallback().or(e.attr("data-copy-classes-option")).or(i.copyClassesOption).or(!1).value(),labels:{selectAll:this.fallback().or(e.attr("data-label-select-all")).or((i.labels||{}).selectAll).or("Select all").value(),optionsSelected:this.fallback().or(e.attr("data-label-options-selected")).or((i.labels||{}).optionsSelected).or("options selected").value(),validFeedback:this.fallback().or(e.attr("data-label-valid-feedback")).or((i.labels||{}).validFeedback).or("Ok").value(),invalidFeedback:this.fallback().or(e.attr("data-label-invalid-feedback")).or((i.labels||{}).invalidFeedback).or("Incorrect value").value(),noSearchResults:this.fallback().or(e.attr("data-label-no-search-results")).or((i.labels||{}).noSearchResults).or("No results").value()},keyboardActiveClass:this.fallback().or(e.attr("data-keyboard-active-class")).or(i.keyboardActiveClass).or("heavy-rain-gradient").value(),placeholder:this.fallback().or(e.attr("data-placeholder")).or(i.placeholder).or(null).value(),visibleOptions:this.fallback().or(e.attr("data-visible-options")).or(i.visibleOptions).or(5).value(),maxSelectedOptions:this.fallback().or(e.attr("data-max-selected-options")).or(i.maxSelectedOptions).or(5).value(),showResetButton:this.fallback().or(e.attr("data-show-reset-button")).or(i.showResetButton).or(!1).value()},this.uuid=e.attr("id")||this.options.selectId||this._randomUUID(),this.view=new MaterialSelectView(e,{options:this.options,properties:{id:this.uuid}}),this.selectedOptionsIndexes=[],t.mutationObservers=[]}get isInitialized(){return Boolean(this.view.$nativeSelect.data("select-id"))&&this.view.$nativeSelect.hasClass("initialized")}static clearMutationObservers(){t.mutationObservers.forEach(e=>{e.disconnect(),e.customStatus="stopped"})}static mdbSelectAutoInit(){e(".mdb-select.mdb-select-autoinit").materialSelect()}init(){this.options.destroy?this.view.destroy():(this.isInitialized&&this.view.destroy(),this.view.render(),this.view.selectPreselectedOptions(e=>this._toggleSelectedValue(e)),this.bindEvents())}bindEvents(){this.bindMutationObserverChange(),this.view.isEditable&&this.view.isSearchable&&this.view.bindResetButtonClick(()=>this._resetSelection()),this.view.bindAddNewOptionClick(),this.view.bindMaterialSelectFocus(),this.view.bindMaterialSelectClick(),this.view.bindMaterialSelectBlur(),this.view.bindMaterialOptionsListTouchstart(),this.view.bindMaterialSelectKeydown(),this.view.bindMaterialSelectDropdownToggle(),this.view.bindToggleAllClick(e=>this._toggleSelectedValue(e)),this.view.bindMaterialOptionMousedown(),this.view.bindMaterialOptionClick(e=>this._toggleSelectedValue(e)),!this.view.isMultiple&&this.view.isSearchable&&this.view.bindSingleMaterialOptionClick(),this.view.isSearchable&&this.view.bindSearchInputKeyup(),this.view.bindHtmlClick(),this.view.bindMobileDevicesMousedown(),this.view.bindSaveBtnClick()}bindMutationObserverChange(){const e={attributes:!0,childList:!0,characterData:!0,subtree:!0},i=new MutationObserver(this._onMutationObserverChange.bind(this));i.observe(this.view.$nativeSelect.get(0),e),i.customId=this.uuid,i.customStatus="observing",t.clearMutationObservers(),t.mutationObservers.push(i)}_onMutationObserverChange(i){i.forEach(i=>{const a=e(i.target).closest("select");!0!==a.data("stop-refresh")&&("childList"===i.type||"attributes"===i.type&&e(i.target).is("option"))&&(t.clearMutationObservers(),a.materialSelect({destroy:!0}),a.materialSelect())})}_resetSelection(){this.selectedOptionsIndexes=[],this.view.$nativeSelect.find("option").prop("selected",!1)}_toggleSelectedValue(e){const t=this.selectedOptionsIndexes.indexOf(e),i=-1!==t;return i?this.selectedOptionsIndexes.splice(t,1):this.selectedOptionsIndexes.push(e),this.view.$nativeSelect.find("option").eq(e).prop("selected",!i),this._setValueToMaterialSelect(),!i}_setValueToMaterialSelect(){let e="";const t=this.selectedOptionsIndexes.length;this.selectedOptionsIndexes.forEach(t=>e+=", "+this.view.$nativeSelect.find("option").eq(t).text().replace(/  +/g," ").trim()),e=this.options.maxSelectedOptions>=0&&t>this.options.maxSelectedOptions?`${t} ${this.options.labels.optionsSelected}`:e.substring(2),0===e.length&&(e=this.view.$nativeSelect.find("option:disabled").eq(0).text()),this.view.$nativeSelect.siblings(""+(this.options.defaultMaterialInput?"input.multi-bs-select":"input.select-dropdown")).val(e)}_randomUUID(){let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)})}fallback(){return{_value:void 0,or(e){return"undefined"!==typeof e&&"undefined"===typeof this._value&&(this._value=e),this},value(){return this._value}}}}e.fn.materialSelect=function(i){e(this).not(".browser-default").not(".custom-select").each((function(){const a=new t(e(this),i);a.init()}))},function(i){e.fn.val=function(e){if(!arguments.length)return i.call(this);if(!0!==this.data("stop-refresh")&&this.hasClass("mdb-select")&&this.hasClass("initialized")){t.clearMutationObservers(),this.materialSelect({destroy:!0});const a=i.call(this,e);return this.materialSelect(),a}return i.call(this,e)}}(e.fn.val),t.mdbSelectAutoInit()});