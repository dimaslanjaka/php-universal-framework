var formField,count=-1,storageKey=location.pathname.replace(/\/$/s,"")+"/formField",formSaved=localStorage.getItem(storageKey.toString());formField=formSaved?JSON.parse(formSaved):[];var uniqueid=guid();function smartform(){var t=function(){$("input,textarea,select").each((function(t,e){$(this).smartForm()}))};t()}function copyToClipboard(t,e){var o=document.queryCommandSupported("copy"),a=e.attr("data-original-title");if(!0===o){var r=document.createElement("textarea");r.value=t,document.body.appendChild(r),r.select();try{var i=document.execCommand("copy"),n=i?"Copied!":"Whoops, not copied!";e.attr("data-original-title",n),e.tooltip("show")}catch(c){console.log("Oops, unable to copy")}document.body.removeChild(r),e.attr("data-original-title",a)}else window.prompt("Copy to clipboard: Ctrl+C or Command+C, Enter",t)}(function(t){t.fn.getIDName=function(){if(!t(this).attr("id")||""==t(this).attr("id")){try{if(count in formField)t(this).attr("id",formField[count]);else{var e=Math.random().toString(20).substr(2,6);t(this).attr("id",e),formField[count]=e,localStorage.setItem(storageKey.toString(),JSON.stringify(formField))}}catch(o){console.error(o),console.log(formField,typeof formField)}count++}return t(this).attr("aria-autovalue")&&t(this).val(uniqueid),"["+location.pathname.replace(/\/$/,"")+"/"+t(this).prop("tagName")+"/"+t(this).attr("id")+"/"+t(this).attr("name")||"empty]"},t.fn.smartForm=function(){if(count++,!t(this).attr("no-save")){var e,o=t(this);o.attr("aria-smartform",uniqueid);var a=o.getIDName().toString(),r=t(this).attr("type");if(a){if("checkbox"===r){if(e=JSON.parse(localStorage.getItem(a)),null===e)return;return void t(this).prop("checked",e)}if("radio"===r)return e="on"===localStorage.getItem(a),void t(this).prop("checked",e);if(e=localStorage.getItem(a),null===e||!e.toString().length)return;t(this).val(e)}}},t(document).bind("DOMNodeInserted",(function(){var e=t(this),o=localStorage.getItem(e.getIDName().toString()),a=e.prop("tagName"),r=!e.attr("no-save")&&e.attr("aria-smartform")&&"undefined"!=typeof a;if(r&&o)switch(console.log(a,r&&o),e.prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":e.val(o);break}})),t(document).bind("DOMNodeRemoved",(function(){var e=t(this),o=!e.attr("no-save")&&e.attr("aria-smartform");if(o)switch(e.prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":e.off("change");break}})),t(document).on("change","select, input, textarea",(function(e){var o=this,a=t(this),r=a.getIDName().toString(),i=a.val(),n=!a.attr("no-save")&&a.attr("aria-smartform");if(r&&""!==i&&n){if("checkbox"==a.attr("type"))return localStorage.setItem(r,a.is(":checked").toString()),void console.log("save checkbox button ",t(this).offset());if("radio"==a.attr("type")&&a.attr("id"))return t('[name="'+a.attr("name")+'"]').each((function(e,o){localStorage.setItem(t(this).getIDName().toString(),"off")})),void setTimeout((function(){localStorage.setItem(r,i.toString()),console.log("save radio button ",t(o).offset())}),500);localStorage.setItem(r,i.toString())}})),t(document).on("focus","input,textarea,select",(function(){var e=t(this);e.getIDName();var o=e.attr("aria-smartform");o&&o!=uniqueid&&(e.smartForm(),e.attr("aria-smartform",uniqueid))}))})(jQuery);