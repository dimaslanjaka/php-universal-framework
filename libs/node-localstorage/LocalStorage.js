var tslib_1 = require("tslib");
// Generated by CoffeeScript 2.5.1
(function () {
    var JSONStorage, KEY_FOR_EMPTY_STRING, LocalStorage, MetaKey, QUOTA_EXCEEDED_ERR, StorageEvent, _emptyDirectory, _escapeKey, _rm, createMap, events, fs, path, writeSync;
    path = require('path');
    fs = require('fs');
    events = require('events');
    writeSync = require('write-file-atomic').sync;
    KEY_FOR_EMPTY_STRING = '---.EMPTY_STRING.---'; // Chose something that no one is likely to ever use
    _emptyDirectory = function (target) {
        var i, len, p, ref, results;
        ref = fs.readdirSync(target);
        results = [];
        for (i = 0, len = ref.length; i < len; i++) {
            p = ref[i];
            results.push(_rm(path.join(target, p)));
        }
        return results;
    };
    _rm = function (target) {
        if (fs.statSync(target).isDirectory()) {
            _emptyDirectory(target);
            return fs.rmdirSync(target);
        }
        else {
            return fs.unlinkSync(target);
        }
    };
    _escapeKey = function (key) {
        var newKey;
        if (key === '') {
            newKey = KEY_FOR_EMPTY_STRING;
        }
        else {
            newKey = key.toString();
        }
        return newKey;
    };
    QUOTA_EXCEEDED_ERR = /** @class */ (function (_super) {
        tslib_1.__extends(QUOTA_EXCEEDED_ERR, _super);
        function QUOTA_EXCEEDED_ERR(message) {
            if (message === void 0) { message = 'Unknown error.'; }
            var _this = _super.call(this) || this;
            _this.message = message;
            if (Error.captureStackTrace != null) {
                Error.captureStackTrace(_this, _this.constructor);
            }
            _this.name = _this.constructor.name;
            return _this;
        }
        QUOTA_EXCEEDED_ERR.prototype.toString = function () {
            return this.name + ": " + this.message;
        };
        return QUOTA_EXCEEDED_ERR;
    }(Error));
    StorageEvent = /** @class */ (function () {
        function StorageEvent(key1, oldValue1, newValue1, url, storageArea) {
            if (storageArea === void 0) { storageArea = 'localStorage'; }
            this.key = key1;
            this.oldValue = oldValue1;
            this.newValue = newValue1;
            this.url = url;
            this.storageArea = storageArea;
        }
        return StorageEvent;
    }());
    MetaKey = /** @class */ (function () {
        function MetaKey(key1, index1) {
            this.key = key1;
            this.index = index1;
            if (!(this instanceof MetaKey)) {
                return new MetaKey(this.key, this.index);
            }
        }
        return MetaKey;
    }());
    createMap = function () {
        var Map;
        Map = function () { };
        Map.prototype = Object.create(null);
        return new Map();
    };
    LocalStorage = (function () {
        var instanceMap;
        var LocalStorage = /** @class */ (function (_super) {
            tslib_1.__extends(LocalStorage, _super);
            function LocalStorage(_location, quota) {
                if (quota === void 0) { quota = 5 * 1024 * 1024; }
                var _this = this;
                var handler;
                _this = _super.call(this) || this;
                _this._location = _location;
                _this.quota = quota;
                // super(_location, quota)
                // @_location = _location
                // @quota = quota
                if (!(_this instanceof LocalStorage)) {
                    return new LocalStorage(_this._location, _this.quota);
                }
                _this._location = path.resolve(_this._location);
                if (instanceMap[_this._location] != null) {
                    return instanceMap[_this._location];
                }
                _this.length = 0; // !TODO: Maybe change this to a property with __defineProperty__
                _this._bytesInUse = 0;
                _this._keys = [];
                _this._metaKeyMap = createMap();
                _this._eventUrl = "pid:" + process.pid;
                _this._init();
                _this._QUOTA_EXCEEDED_ERR = QUOTA_EXCEEDED_ERR;
                if (typeof Proxy !== "undefined" && Proxy !== null) {
                    handler = {
                        set: function (receiver, key, value) {
                            if (_this[key] != null) {
                                return _this[key] = value;
                            }
                            else {
                                return _this.setItem(key, value);
                            }
                        },
                        get: function (receiver, key) {
                            if (_this[key] != null) {
                                return _this[key];
                            }
                            else {
                                return _this.getItem(key);
                            }
                        }
                    };
                    instanceMap[_this._location] = new Proxy(_this, handler);
                    return instanceMap[_this._location];
                }
                // else it'll return this
                instanceMap[_this._location] = _this;
                return instanceMap[_this._location];
            }
            LocalStorage.prototype._init = function () {
                var _MetaKey, _decodedKey, _keys, e, i, index, k, len, stat;
                try {
                    stat = fs.statSync(this._location);
                    if ((stat != null) && !stat.isDirectory()) {
                        throw new Error("A file exists at the location '" + this._location + "' when trying to create/open localStorage");
                    }
                    // At this point, it exists and is definitely a directory. So read it.
                    this._bytesInUse = 0;
                    this.length = 0;
                    _keys = fs.readdirSync(this._location);
                    for (index = i = 0, len = _keys.length; i < len; index = ++i) {
                        k = _keys[index];
                        _decodedKey = decodeURIComponent(k);
                        this._keys.push(_decodedKey);
                        _MetaKey = new MetaKey(k, index);
                        this._metaKeyMap[_decodedKey] = _MetaKey;
                        stat = this._getStat(k);
                        if ((stat != null ? stat.size : void 0) != null) {
                            _MetaKey.size = stat.size;
                            this._bytesInUse += stat.size;
                        }
                    }
                    this.length = _keys.length;
                }
                catch (error) {
                    e = error;
                    // If it errors, that might mean it didn't exist, so try to create it
                    if (e.code !== "ENOENT") {
                        throw e;
                    }
                    try {
                        fs.mkdirSync(this._location, {
                            recursive: true
                        });
                    }
                    catch (error) {
                        e = error;
                        if (e.code !== "EEXIST") {
                            throw e;
                        }
                    }
                }
            };
            LocalStorage.prototype.setItem = function (key, value) {
                var encodedKey, evnt, existsBeforeSet, filename, hasListeners, metaKey, oldLength, oldValue, valueString, valueStringLength;
                hasListeners = events.EventEmitter.listenerCount(this, 'storage');
                oldValue = null;
                if (hasListeners) {
                    oldValue = this.getItem(key);
                }
                key = _escapeKey(key);
                encodedKey = encodeURIComponent(key);
                filename = path.join(this._location, encodedKey);
                valueString = value.toString();
                valueStringLength = valueString.length;
                metaKey = this._metaKeyMap[key];
                existsBeforeSet = !!metaKey;
                if (existsBeforeSet) {
                    oldLength = metaKey.size;
                }
                else {
                    oldLength = 0;
                }
                if (this._bytesInUse - oldLength + valueStringLength > this.quota) {
                    throw new QUOTA_EXCEEDED_ERR();
                }
                writeSync(filename, valueString, 'utf8');
                if (!existsBeforeSet) {
                    metaKey = new MetaKey(encodedKey, (this._keys.push(key)) - 1);
                    metaKey.size = valueStringLength;
                    this._metaKeyMap[key] = metaKey;
                    this.length += 1;
                    this._bytesInUse += valueStringLength;
                }
                if (hasListeners) {
                    evnt = new StorageEvent(key, oldValue, value, this._eventUrl);
                    return this.emit('storage', evnt);
                }
            };
            LocalStorage.prototype.getItem = function (key) {
                var filename, metaKey;
                key = _escapeKey(key);
                metaKey = this._metaKeyMap[key];
                if (!!metaKey) {
                    filename = path.join(this._location, metaKey.key);
                    if (fs.existsSync(filename)) {
                        return fs.readFileSync(filename, 'utf8');
                    }
                    else {
                        return false;
                    }
                }
                else {
                    return null;
                }
            };
            LocalStorage.prototype._getStat = function (key) {
                var filename;
                key = _escapeKey(key);
                filename = path.join(this._location, encodeURIComponent(key));
                try {
                    return fs.statSync(filename);
                }
                catch (error) {
                    return null;
                }
            };
            LocalStorage.prototype.removeItem = function (key) {
                var evnt, filename, hasListeners, k, meta, metaKey, oldValue, ref, v;
                key = _escapeKey(key);
                metaKey = this._metaKeyMap[key];
                if (!!metaKey) {
                    hasListeners = events.EventEmitter.listenerCount(this, 'storage');
                    oldValue = null;
                    if (hasListeners) {
                        oldValue = this.getItem(key);
                    }
                    delete this._metaKeyMap[key];
                    this.length -= 1;
                    this._bytesInUse -= metaKey.size;
                    filename = path.join(this._location, metaKey.key);
                    this._keys.splice(metaKey.index, 1);
                    ref = this._metaKeyMap;
                    for (k in ref) {
                        v = ref[k];
                        meta = this._metaKeyMap[k];
                        if (meta.index > metaKey.index) {
                            meta.index -= 1;
                        }
                    }
                    _rm(filename);
                    if (hasListeners) {
                        evnt = new StorageEvent(key, oldValue, null, this._eventUrl);
                        return this.emit('storage', evnt);
                    }
                }
            };
            LocalStorage.prototype.key = function (n) {
                var rawKey;
                rawKey = this._keys[n];
                if (rawKey === KEY_FOR_EMPTY_STRING) {
                    return '';
                }
                else {
                    return rawKey;
                }
            };
            LocalStorage.prototype.clear = function () {
                var evnt;
                _emptyDirectory(this._location);
                this._metaKeyMap = createMap();
                this._keys = [];
                this.length = 0;
                this._bytesInUse = 0;
                if (events.EventEmitter.listenerCount(this, 'storage')) {
                    evnt = new StorageEvent(null, null, null, this._eventUrl);
                    return this.emit('storage', evnt);
                }
            };
            LocalStorage.prototype._getBytesInUse = function () {
                return this._bytesInUse;
            };
            LocalStorage.prototype._deleteLocation = function () {
                delete instanceMap[this._location];
                _rm(this._location);
                this._metaKeyMap = {};
                this._keys = [];
                this.length = 0;
                return this._bytesInUse = 0;
            };
            return LocalStorage;
        }(events.EventEmitter));
        ;
        instanceMap = {};
        return LocalStorage;
    }).call(this);
    JSONStorage = /** @class */ (function (_super) {
        tslib_1.__extends(JSONStorage, _super);
        function JSONStorage() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        JSONStorage.prototype.setItem = function (key, value) {
            var newValue;
            newValue = JSON.stringify(value);
            return _super.prototype.setItem.call(this, key, newValue);
        };
        JSONStorage.prototype.getItem = function (key) {
            return JSON.parse(_super.prototype.getItem.call(this, key));
        };
        return JSONStorage;
    }(LocalStorage));
    exports.LocalStorage = LocalStorage;
    exports.JSONStorage = JSONStorage;
    exports.QUOTA_EXCEEDED_ERR = QUOTA_EXCEEDED_ERR;
}).call(this);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTG9jYWxTdG9yYWdlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL25vZGUtbG9jYWxzdG9yYWdlL0xvY2FsU3RvcmFnZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsa0NBQWtDO0FBQ2xDLENBQUM7SUFDQyxJQUFJLFdBQVcsRUFBRSxvQkFBb0IsRUFBRSxZQUFZLEVBQUUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLFlBQVksRUFBRSxlQUFlLEVBQUUsVUFBVSxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsU0FBUyxDQUFDO0lBRXpLLElBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFdkIsRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUVuQixNQUFNLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBRTNCLFNBQVMsR0FBRyxPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFFOUMsb0JBQW9CLEdBQUcsc0JBQXNCLENBQUMsQ0FBQyxvREFBb0Q7SUFFbkcsZUFBZSxHQUFHLFVBQVMsTUFBTTtRQUMvQixJQUFJLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUM7UUFDNUIsR0FBRyxHQUFHLEVBQUUsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDN0IsT0FBTyxHQUFHLEVBQUUsQ0FBQztRQUNiLEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBRSxHQUFHLEdBQUcsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQzFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDWCxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLENB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